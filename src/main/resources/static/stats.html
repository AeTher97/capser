<html>
<head>
    <link rel="stylesheet" type="text/css" href="capsStyle.css">
    <meta charset="UTF-8">
    <title>Stats</title>
</head>
<body>
<form>
    <div id="stats">Loading...</div>
</form>
<br>
<form action="stats.html" method="get">
    <div>
        <label for="names">Player name</label>
        <div id="names">Loading...</div>
    </div>
    <div>
        <button>Find player stats</button>
    </div>
</form>
<form action="index.html">
    <div>
        <button>Go back</button>
    </div>
</form>

<br>
<div id="buildNumber" class="parent"></div>

<script async>var data = null;

var xhr = new XMLHttpRequest();
xhr.withCredentials = true;

xhr.addEventListener("readystatechange", function () {
    if (this.readyState === 4) {
        console.log(this.responseText);
        document.getElementById("stats").innerHTML = this.responseText;
    }
});

try {
    var id = new URL(window.location.href).searchParams.get("id");
} catch (err) {
    console.log("Error while getting search param.");
}

if (id) {
    xhr.open("GET", "/stats" + "?id=" + id);
} else {
    xhr.open("GET", "/stats");
}

xhr.setRequestHeader("User-Agent", "PostmanRuntime/7.15.0");
xhr.setRequestHeader("Accept", "*/*");
xhr.setRequestHeader("Cache-Control", "no-cache");
xhr.setRequestHeader("Postman-Token", "261bb4e1-ce3c-42c6-9a4a-2a2cbb387aaf,d09d24ad-be63-47b3-94e2-0a3f79aca57a");
xhr.setRequestHeader("Host", "localhost:8888");
xhr.setRequestHeader("accept-encoding", "gzip, deflate");
xhr.setRequestHeader("Connection", "keep-alive");
xhr.setRequestHeader("cache-control", "no-cache");

xhr.send(data);

</script>
<script async>

var xhr2 = new XMLHttpRequest();
xhr2.withCredentials = true;

xhr2.addEventListener("readystatechange", function () {
    if (this.readyState === 4) {
        console.log(this.responseText);
        document.getElementById("buildNumber").innerHTML = this.responseText;
    }
});

xhr2.open("GET", "/version");
xhr2.setRequestHeader("User-Agent", "PostmanRuntime/7.15.0");
xhr2.setRequestHeader("Accept", "*/*");
xhr2.setRequestHeader("Cache-Control", "no-cache");
xhr2.setRequestHeader("Postman-Token", "261bb4e1-ce3c-42c6-9a4a-2a2cbb387aaf,d09d24ad-be63-47b3-94e2-0a3f79aca57a");
xhr2.setRequestHeader("Host", "localhost:8888");
xhr2.setRequestHeader("accept-encoding", "gzip, deflate");
xhr2.setRequestHeader("Connection", "keep-alive");
xhr2.setRequestHeader("cache-control", "no-cache");

xhr2.send(data);
</script>
<script async>

    var xhr3 = new XMLHttpRequest();
    xhr3.withCredentials = true;

    xhr3.addEventListener("readystatechange", function () {
        if (this.readyState === 4) {
            console.log(this.responseText);
            document.getElementById("names").innerHTML = this.responseText;
        }
    });
    xhr3.open("GET", "/playerIdsAndNames?type=id");
    xhr3.setRequestHeader("User-Agent", "PostmanRuntime/7.15.0");
    xhr3.setRequestHeader("Accept", "*/*");
    xhr3.setRequestHeader("Cache-Control", "no-cache");
    xhr3.setRequestHeader("Postman-Token", "261bb4e1-ce3c-42c6-9a4a-2a2cbb387aaf,d09d24ad-be63-47b3-94e2-0a3f79aca57a");
    xhr3.setRequestHeader("Host", "localhost:8888");
    xhr3.setRequestHeader("accept-encoding", "gzip, deflate");
    xhr3.setRequestHeader("Connection", "keep-alive");
    xhr3.setRequestHeader("cache-control", "no-cache");

    xhr3.send(data);
</script>
</body>
</html>